<!DOCTYPE html>
<html>
  <head>
    <title>Site Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <%= stylesheet_link_tag    'application', 'mercury', :media => 'all' %>
    <%= stylesheet_link_tag "http://fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic,900italic" %>
    <%= javascript_include_tag 'application', 'mercury' %>
    <%= csrf_meta_tags %>
  </head>
  <body>

    <a href="#" class="scrolltop" style="display: none; ">
      <span>up</span>
    </a>

    <%= render 'layouts/header' %>

    <div class='container'>
      <div class='row'>
        <div class='span6'>

          <% name = Site.find(request.filtered_parameters['requested_uri']).subdomain %>
          <h3 class='section_header left'>
            Edit <%= name %>
          </h3>

          <p>
          <button id='save_button' class="btn btn-large btn-success">
            <i class='icon-save icon-large'></i>
            Save
          </button>
          <button id='preview_button' class="btn btn-large btn-success" data-toggle='button'>
            <i class='icon-eye-open icon-large'></i>
            Preview
          </button>
          </p>

          <br></br>

          <ul class='nav nav-tabs'>
            <li><a href='#style' data-toggle='pill'>Templates</a></li>
            <li class='active'><a href='#widget' data-toggle='pill'>Add-ons</a></li>
          </ul>

          <div class='tab-content'>
            <div class='tab-pane fade' id='style'>
              <div id="styles">
                <ul class='thumbnails'>
                  <% theme = %w(A B C D E F G H I J K) %>
                  <% theme.each do |t| %>
                    <li class='span2'>
                    <%= link_to(image_tag("#{t}.png"), '#', id:"theme#{t}", class:'thumbnail')%>
                    </li>
                  <% end %>
                </ul>
              </div>
            </div>

            <div class='tab-pane active fade in' id='widget'>
              <ul class='snippets thumbnails'>
                <li class='span2'>
                <a href='#' class='thumbnail'>
                  <img alt="Snippet Name" data-snippet="embedded_map" data-options="false" src="/assets/map.png">
                </a>
                </li>
                <li class='span2'>
                <a href='#' class='thumbnail'>
                  <img alt="Snippet Name" data-snippet="carousel" data-options="false" src="/assets/slideshow.png">
                </a>
                </li>
                <li class='span2'>
                <a href='#' class='thumbnail'>
                  <img alt="Snippet Name" data-snippet="fb_checkin" data-options="false" src="/assets/fb_checkin.png">
                </a>
                </li>
                <li class='span2'>
                <a href='#' class='thumbnail'>
                  <img alt="Snippet Name" data-snippet="fb_like" data-options="false" src="/assets/fb_like.png">
                </a>
                </li>
                <li class='span2'>
                <a href='#' class='thumbnail'>
                  <img alt="Snippet Name" data-snippet="youtube" data-options="false" src="/assets/youtube.png">
                </a>
                </li>
              </ul>
            </div>
          </div>

        </div>

        <div class='span6'>
          <div class='mobile'>
            <div class='screen' id='mobile_screen'>
              <%#the editor frame should go here%>
            </div>
          </div>  
        </div>

      </div>
    </div>

    <script type="text/javascript">
      // Set to the url that you want to save any given page to, leave null for default handling.
      // this will be a POST request
      var saveUrl = "<%= site_path(request.params[:requested_uri].to_i, params: { mobile: 1 }) %>";

      // Instantiate the PageEditor
      new Mercury.PageEditor(saveUrl, {
        saveStyle:  null, // 'form', or 'json' (default json)
        saveMethod: null, // 'PUT', or 'POST', (create, vs. update -- default PUT)
        visible:    true,  // boolean - if the interface should start visible or not
        iframeSrcUrl: "<%= site_path(request.params[:requested_uri].to_i, params: { mobile: 1 }) %>",
        appendTo: '#mobile_screen'
      });
    </script>
  </body>
</html>
